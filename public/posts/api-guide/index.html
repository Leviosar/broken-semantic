<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="Introduction A significant amount of a web developer&rsquo;s work consists of writing or consuming APIs. The consume part is commonly easy: you read the docs, generate your credentials, plan on what resources you need and implement an integration on your target app (now that i wrote all the steps maybe it&rsquo;s not so easy). In the worst case you end up with a messy (but functional) implementation that gets the job done.">
<title>Just another opinionated API building guide.</title>

<link rel='canonical' href='http://localhost:1313/posts/api-guide/'>

<link rel="stylesheet" href="/scss/style.min.0304c6baf04e01a8fe70693791cb744d56a3578a3120a8796cefc66825aa39c7.css"><meta property='og:title' content="Just another opinionated API building guide.">
<meta property='og:description' content="Introduction A significant amount of a web developer&rsquo;s work consists of writing or consuming APIs. The consume part is commonly easy: you read the docs, generate your credentials, plan on what resources you need and implement an integration on your target app (now that i wrote all the steps maybe it&rsquo;s not so easy). In the worst case you end up with a messy (but functional) implementation that gets the job done.">
<meta property='og:url' content='http://localhost:1313/posts/api-guide/'>
<meta property='og:site_name' content='Broken Semantics'>
<meta property='og:type' content='article'><meta property='article:section' content='Posts' /><meta property='article:published_time' content='2024-05-04T16:14:42-03:00'/><meta property='article:modified_time' content='2024-05-04T16:14:42-03:00'/>
<meta name="twitter:title" content="Just another opinionated API building guide.">
<meta name="twitter:description" content="Introduction A significant amount of a web developer&rsquo;s work consists of writing or consuming APIs. The consume part is commonly easy: you read the docs, generate your credentials, plan on what resources you need and implement an integration on your target app (now that i wrote all the steps maybe it&rsquo;s not so easy). In the worst case you end up with a messy (but functional) implementation that gets the job done.">
    <link rel="shortcut icon" href="/favicon.png" />

  


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/images/avatar_hu6b04672fe02caa61da0f3643fa5125f9_20261_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üç•</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Broken Semantics</a></h1>
            <h2 class="site-description">Work hard, study well, and eat and sleep plenty! That is the Turtle Hermit way!</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/leviosar'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://x.com/jaovem'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#the-_theorical_-stuff">The <em>theorical</em> stuff</a>
      <ol>
        <li><a href="#architecture">Architecture</a></li>
        <li><a href="#goals">Goals</a>
          <ol>
            <li><a href="#understandability">Understandability</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/posts/api-guide/">Just another opinionated API building guide.</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">May 04, 2024</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    6 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="introduction">Introduction
</h2><p>A significant amount of a web developer&rsquo;s work consists of writing or consuming APIs. The consume part is commonly easy: you read the docs, generate your credentials, plan on what resources you need and implement an integration on your target app (now that i wrote all the steps maybe it&rsquo;s not so easy). In the worst case you end up with a messy (but functional) implementation that gets the job done.</p>
<p>On the other hand, writing can be more tricky and complex, involving skills that usually surpasses basic development knowledge. Sure, this applies if you want to write a <em>good</em> API. But what are the parameters we can use to classify and API as <em>good</em> or <em><del>(a piece of shit)</del> bad</em>? If you ask this to ten people you might receive 10 slightly different answers, but i believe most of them will gravitate towards some basic principles that are sometimes forgotten.</p>
<p>This article is divided in two partes, starting with a theoretical discussion about outstanding points that may contribute to improve the general quality of an API, followed by a practical example of structuring an API. As the article name suggests, the content is highly based on my experiences and opinions of how that kind of software should be built. You may disagree on some or all the points presented and we can chat about it, maybe you&rsquo;re right and i&rsquo;ve been doing things wrong all this time, so feel free to leave a comment or reach me in my social networks. Just don&rsquo;t be an asshole.</p>
<p>And now, with no further considerations, let&rsquo;s beg - OH SHIT! i&rsquo;ve forgot to mention, we&rsquo;ll talk about REST APIs. Not SOAP, not GraphQL, not RPC, just REST. Why? Well, it&rsquo;s what i&rsquo;m most used to and still highly relevant for any developer.</p>
<p>Okay, all things said, please take a seat.</p>
<h2 id="the-_theorical_-stuff">The <em>theorical</em> stuff
</h2><p>First of all, i think it&rsquo;s useful to remember what&rsquo;s an API conceptually. The acronym stands for <em>Application Programming Interface</em> and that&rsquo;s pretty self-explanatory. We have an application and there&rsquo;s need to programatically read or alter this applications&rsquo;s state so we build and use and interface to achieve this goal. That being said, the range of how to build an API is ridiculously wide, you can receive bitmaps encoded with data through FTP, perform actions based on the data and call it a day. It would be an API, a really funny one but also highly inefficient and confuse.</p>
<p>If any programmer write APIs at their own way we have chaos and if you work with the web you know there&rsquo;s already enough chaos to unleash hell in there. So, we define patterns, architectures, conventions and a whole lot of imaginary abstractions to help us mantain a little bit of order on some places of the web. Each one of these ethereal abstractions have real positive and negative scenarios to be applied, some are more generic, others extremely specified for a use case.</p>
<h3 id="architecture">Architecture
</h3><p>A widely adopted abstraction for building network-based applications is the REST architecture. It was proposed by Roy Fielding on his <a class="link" href="https://ics.uci.edu/~fielding/pubs/dissertation/fielding_dissertation.pdf"  target="_blank" rel="noopener"
    >PhD Thesis</a> and describes the web as a huge <a class="link" href="https://en.wikipedia.org/wiki/Finite-state_machine"  target="_blank" rel="noopener"
    >finite state machine</a> containing virtual resources that are accessible by state-transition functions using the resource&rsquo;s identifier. For me, that&rsquo;s a beautiful idealistic way to think about the web, but is also for big nerds. If you&rsquo;re a big nerd like me, Fielding&rsquo;s thesis is pure gold.</p>
<p>If you do not fall into the big nerd category, the main takeways of REST&rsquo;s definitions are here formatted on a nice bullet list.</p>
<ul>
<li>
<p><strong>Client/Server architecture</strong>: there has to be a clear hierarchical separation between the machine requesting the resource and the machine providing it.</p>
</li>
<li>
<p><strong>Statelessness</strong>: a resource request must be self-contained, all the information necessary for the server must be present on the request. Achieving this on HTTP is pretty easy since the protocol itself is stateless (altough there are <a class="link" href="https://stackoverflow.com/questions/6068113/do-sessions-really-violate-restfulness"  target="_blank" rel="noopener"
    >passionated discussions</a> about sessions, cookies or auth tokens breaking this principle)</p>
</li>
<li>
<p><strong>Uniform interfaces</strong>: when a client is a specific resource the server should always respond with the same interface. If the client requests for a product with the identifier 1, another client requesting the same product should receive the same answer (excluding situations where the resource itself was modified by another request).</p>
</li>
<li>
<p><strong>Layered System</strong>: the client should not be able to distinguish the final server from an intermediary service (proxies, gateways, caching systems). This is useful to add new layers of abstraction without disrupt the final service.</p>
</li>
<li>
<p><strong>Cacheability</strong>: the server should mark responses as cacheable or not and provide information about the expiration or validity of the cached resource. If a specific resource is not cacheable by a business rule that&rsquo;s fine, you should just mark it as non-cacheable. (But please use cache where it fits).</p>
</li>
</ul>
<p>There&rsquo;s also a sixth principle about executing code sent from the server into the clients machine, but i personally think that&rsquo;s sketchy and can lead to weird behaviors, excessive attachment between client and server and security issues. Because this is an opinionated guide i will not teach you this wicked sorcery, if you want to know more about it you can read Fielding&rsquo;s thesis.</p>
<p>Since the architecture was proposed developers from all types of backgrounds adopted and started building APIs based on those principles and calling the result a <em>RESTful</em> API. Of course, real world situations sometimes require changes and tweaks on architectures to comply with the software&rsquo;s requirements so most of the attemps to follow REST guidelines are not completelly compliant with the specs. The most fervorous REST evangelists (and <a class="link" href="https://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven"  target="_blank" rel="noopener"
    >Fielding itself</a>) rant about any degeneration of the sacred REST book.</p>
<p>I prefer to admit that the architecture can&rsquo;t handle alone all the complexity (technical or not) of software development and describe those partial implementations as <em>RESTlike</em>. That&rsquo;s usually my go-to approach when designing a new API so the further developments on this guide will be founded on a <em>RESTlike</em> application.</p>
<h3 id="goals">Goals
</h3><p>Now that i&rsquo;ve explained the foundation of what we&rsquo;re building it&rsquo;s time to describe which goals we&rsquo;ll try to reach. Those objectives are gathered on a mix of technical knowledge and empirical experience on past projects i&rsquo;ve worked. In some of the points the architecture itself will help us achieve the goal, in others we&rsquo;ll have to modify or complement concepts of the REST principles. Remember, this article is not about writing the <strong>perfect RESTful API</strong> but a good API in general.</p>
<h4 id="understandability">Understandability
</h4><p>By definition an interface is a connection between two entities who may be unrelated to each other,</p>
<!-- Uma parte significativa do trabalho de uma pessoa programadora que trabalhe com a web √© escrever ou consumir APIs. Consumir costuma ser simples, voc√™ l√™ a documenta√ß√£o, gera suas credenciais, planeja quais recursos precisa consumir e implementar a integra√ß√£o na sua aplica√ß√£o alvo (ok, talvez n√£o t√£o simples assim). No pior dos casos voc√™ vai acabar com uma implementa√ß√£o um pouco confusa mas que ainda assim provavelmente ir√° funcionar e fazer o trabalho a que se prop√µe. -->
<!-- Escrever, por outro lado, √© uma tarefa muito mais complexa e envolve habilidades que muitas vezes ultrapassam o conhecimento t√©cnico mais comum. Claro, isso se voc√™ quiser escrever uma _boa_ API. Mas quais s√£o exatamente os par√¢metros que podemos usar para classificar uma API como _boa_? Se voc√™ perguntar isso para 10 pessoas talvez voc√™ receba 10 respostas ligeiramente diferentes, mas acredito que a maior delas ir√° gravitar em torno de alguns princ√≠pios b√°sicos que muitas vezes s√£o conhecidos mas n√£o s√£o priorizados.

Esse artigo se divide em duas partes, iniciando com uma discuss√£o te√≥rica sobre pontos destac√°veis que podem contribuir para a qualidade geral de uma API, seguido de um exemplo pr√°tico de estrutura√ß√£o de uma API REST -->
<!-- ### Compreensibilidade

Como o acr√¥nimo sugere, uma API √© uma interface entre sua aplica√ß√£o e o mundo exterior, e toda interface para ser √∫til precisa ser compreens√≠vel, esse √© o primeiro desafio de escrever uma API: outras pessoas precisam ser capazes de extrair informa√ß√£o sem precisar te consultar sobre a estrutura toda da API. -->
</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "broken-semantics" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2024 Broken Semantics
    </section>
    
    <section class="powerby">
        
            And still here. <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.26.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
